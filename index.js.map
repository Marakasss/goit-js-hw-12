{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\n\nexport async function getImagesByQuery(query) {\n    \n    const myApiKey = '49580099-ba49dcf3c416d0b66883e5025'; \n    return axios.get('https://pixabay.com/api/', {\n        params: {\n            key: myApiKey,\n            q: query,\n            image_type: 'photo',\n            orientation: 'horizontal',\n            safesearch: true,\n            per_page: 100,\n        }\n    })\n        .then(response => {\n            return response.data.hits\n        })\n\n        .catch(error => {\n            console.error(error);\n            throw error;\n            })\n               \n}\n\n\n\n\n\n ","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nconst BASE_URL = import.meta.env.BASE_URL;\n\nconst gallery = document.querySelector('.gallery');\n\n\n//-----------FUNCTION ADDING CARDS WITH IMAGES TO GALLERY-------------\nexport function createGallery(images) {\n    \n    \n    //ADD PHOTOS TO GALLARY\n    const galleryItemsList = images\n        .map(({ likes,\n                    views,\n                    downloads,\n                    comments,\n                    tags,\n                    largeImageURL = `'${BASE_URL}/img/image-not-found.jpg'`,\n                    webformatURL = `'${BASE_URL}/img/image-not-found.jpg'`  \n                }) =>\n            \n             `<li class=\"img-card\">\n                        <a class=\"gallery-link\" href= \"${largeImageURL}\">\n                            <img\n                            class=\"gallery-image\"\n                            src= \"${webformatURL}\"\n                            alt= \"${tags.split(',')[0].trim()}\"\n                            />\n                        </a>\n                        <ul class=\"img-info\">\n                            <li class=\"info\">\n                                <svg class=\"icon-info\" name=\"like\" width=\"18\" height=\"18\">\n                                    <use href=\"${BASE_URL}/img/sprite.svg#icon-like\"></use>\n                                </svg>\n                                <p>${likes}</p>\n                            </li>\n                            <li class=\"info\">\n                                <svg class=\"icon-info\" width=\"18\" height=\"18\">\n                                    <use href=\"${BASE_URL}/img/sprite.svg#icon-eye\"></use>\n                                </svg>\n                                <p>${views}</p>\n                            </li>\n                            <li class=\"info\">\n                                <svg class=\"icon-info\" width=\"18\" height=\"18\">\n                                    <use href=\"${BASE_URL}/img/sprite.svg#icon-dialog\"></use>\n                                </svg>\n                                <p>${comments}</p>\n                            </li>\n                            <li class=\"info\">\n                                <svg class=\"icon-info\" width=\"18\" height=\"18\">\n                                    <use href=\"${BASE_URL}/img/sprite.svg#icon-gallery-download\"></use>\n                                </svg>\n                                <p>${downloads}</p>\n                            </li>\n                        </ul>\n                    </li>`\n        ).join('');\n    \n    gallery.innerHTML = galleryItemsList;\n    \n     waitForImagesToLoad()\n    const lightbox = new SimpleLightbox('.gallery a', {\n        captionsData: 'alt',\n        captionDelay: 250,\n    });\n\n    lightbox.refresh();\n   \n}\n\nexport function clearGallery() {\n    gallery.innerHTML = ''\n}\n\n\n//------------FUNCTION CHANGED SEARCHBAR ICON COLOR IF SOME VALUE INPUTED------------\n\n\nexport function changeIconColor(icon) {\n    const searchBar = document.querySelector('.form');\n    //removing prev listener = adding nev\n    searchBar.removeEventListener('input', changeColor);\n    searchBar.addEventListener('input', changeColor);\n       \n    function changeColor(event) {\n        icon.style.fill = event.target.value.trim() ? '#1875FF' : '';\n    }\n}\n\n\n//------------------------------------MESSAGES--------------------------------------\n\n\nexport function errorMessage(message) {\n iziToast.error({\n   message: message,\n   position: window.innerWidth <= 768 ? 'bottomCenter' : 'topCenter',\n   transitionIn: 'fadeInDown',\n   backgroundColor: 'rgb(231, 19, 36)',\n   messageColor: 'white',\n   iconColor: 'white',\n   messageSize: '16px',\n   class: 'toast',\n});\n}\n\nexport function infoMessage(message) {\n iziToast.info({\n   message: message,\n   position: window.innerWidth <= 768 ? 'bottomLeft' : 'topLeft',\n   transitionIn: 'fadeInDown',\n   messageSize: '16px',\n});\n}\n\n//-----------------------------------LOADER FUNCTIONS----------------------------------------\n\n\nexport function addLoading() {\n    const loader = document.querySelector('.loader');\n    loader.classList.remove('visually-hidden')\n    gallery.classList.add('visually-hidden')\n    \n    loader.style.display = 'block'\n}\n\nexport function removeLoading() {\n    const loader = document.querySelector('.loader');\n    loader.classList.add('visually-hidden')\n    gallery.classList.remove('visually-hidden')\n    \n    loader.style.display = 'none';  \n}\n\n//Функцію додав щоб вирішити проблему з завантаженням сторінки.\n//Так як у мене likes, views, comemnts, downloads реалізовані іконками\n//то іконки завантажувались швидше за зображення і виглядало це не добре.\nexport function waitForImagesToLoad() {\n    const gallery = document.querySelector('.gallery');\n    if (!gallery) {\n        removeLoading();\n        return;\n    }\n\n    const images = gallery.querySelectorAll('img');\n    let loadedCount = 0;\n\n    if (images.length === 0) {\n        removeLoading(); //Якщо немає зображень, одразу ховаємо лоадер\n        return;\n    }\n\n    images.forEach(img => {\n        if (img.complete && img.naturalHeight !== 0) {\n            loadedCount++; //Якщо зображення вже готове\n        } else {\n            img.onload = () => {\n                loadedCount++;\n                checkIfAllImagesLoaded();\n            };\n            img.onerror = () => {\n                if (!img.src.includes('image-not-found.jpg')) {\n                    img.src = '/goit-js-hw-11/img/image-not-found.jpg'; //ставимо заглушки якщо помилка\n                    img.alt = 'Image not found';\n                    img.onerror = null; \n                }\n                \n                loadedCount++; //Якщо зображення не завантажилося, теж  враховуємо\n                checkIfAllImagesLoaded();\n            };\n        }\n    });\n\n    checkIfAllImagesLoaded();\n\n    if (loadedCount === images.length) {\n        checkIfAllImagesLoaded();\n    }\n\n    function checkIfAllImagesLoaded() {\n        if (loadedCount === images.length) {\n                    removeLoading(); //Ховаємо лоадер тільки коли все намальовано\n        }\n    } \n}\n\n\n//---------------------FUNCTION HANDLE LIKE YOUR FAVORITE IMAGES-----------------------------\n\n\nexport function clickOnlike() {\n    gallery.addEventListener('click', event => {\n        if (event.target.tagName === 'use') {\n            const like = event.target.closest('svg');\n            const likesValue = like.nextElementSibling;\n            \n            if (like.getAttribute('name') === 'like') {\n                let numberOfLikes = Number(likesValue.textContent);\n\n                if (like.style.fill !== 'darkblue') {\n                    like.style.fill = 'darkblue';\n                    like.style.transform = 'scale(1.1)'\n                    likesValue.style.color = 'darkblue';\n                    numberOfLikes++;\n                } else {\n                    like.removeAttribute('style');\n                    likesValue.removeAttribute('style')\n                    numberOfLikes--;\n                }    \n\n                likesValue.textContent = numberOfLikes;\n            }\n            \n        }\n    })\n          \n}\n\n\n","\nimport { getImagesByQuery } from './js/pixabay-api';\nimport { errorMessage, addLoading, changeIconColor, clearGallery, clickOnlike, createGallery,  infoMessage, waitForImagesToLoad } from './js/render-functions';\n\n\nconst searchBar = document.querySelector('.form');\nconst icon = document.querySelector('.icon-img');\n\nfunction handleSubmit() {\n    searchBar.addEventListener('submit', event => {\n        event.preventDefault();\n\n        let query = event.target['search-text'].value.trim();\n        if (!query) {\n            infoMessage('Enter some value');\n            return;\n        }\n \n        addLoading()\n\n        getImagesByQuery(query)\n            \n            .then(images => {\n                \n                if (images.length === 0) {\n                    throw new Error(`Sorry, there are no images matching ${query}. Please try again!`);\n                }\n                \n                createGallery(images)\n            })\n            \n            .catch(error => {\n                if (error.message.includes('no images')) {\n                    infoMessage(error.message);\n                } else {\n                    errorMessage('Something went wrong. Please try again later.');\n                }\n                \n                clearGallery();\n                \n            })\n        \n            .finally(() => {\n                waitForImagesToLoad();\n            })\n            \n    })\n\n}\n    \nchangeIconColor(icon)\nhandleSubmit()\nclickOnlike()  \n    \n"],"names":["getImagesByQuery","query","axios","response","error","BASE_URL","gallery","createGallery","images","galleryItemsList","likes","views","downloads","comments","tags","largeImageURL","webformatURL","waitForImagesToLoad","SimpleLightbox","clearGallery","changeIconColor","icon","searchBar","changeColor","event","errorMessage","message","iziToast","infoMessage","addLoading","loader","removeLoading","loadedCount","img","checkIfAllImagesLoaded","clickOnlike","like","likesValue","numberOfLikes","handleSubmit"],"mappings":"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"}