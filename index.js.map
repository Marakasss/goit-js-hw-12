{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\n\nexport async function getImagesByQuery(query, page = 1) {\n    \n    const myApiKey = '49580099-ba49dcf3c416d0b66883e5025'; \n    const response = await axios.get('https://pixabay.com/api/', {\n        params: {\n            key: myApiKey,\n            q: query,\n            image_type: 'photo',\n            orientation: 'horizontal',\n            safesearch: true,\n            page,\n            per_page: 15,\n        }\n    })\n    return response;\n        \n}\n\n\n\n\n\n ","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport { getImagesByQuery } from \"./pixabay-api\";\nconst BASE_URL = import.meta.env.BASE_URL;\n\nconst gallery = document.querySelector('.gallery');\n\n\n\n//-----------FUNCTION ADDING CARDS WITH IMAGES TO GALLERY-------------\nexport function createGallery(images) {\n    \n    \n    //ADD PHOTOS TO GALLARY\n    const galleryItemsList = images\n        .map(({ likes,\n                    views,\n                    downloads,\n                    comments,\n                    tags,\n                    largeImageURL = '${BASE_URL}/img/image-not-found.jpg',\n                    webformatURL = '${BASE_URL}/img/image-not-found.jpg'  \n                }) =>\n            \n             `<li class=\"img-card\">\n                        <a class=\"gallery-link\" href= \"${largeImageURL}\">\n                            <img\n                            class=\"gallery-image\"\n                            src= \"${webformatURL}\"\n                            alt= \"${tags.split(',')[0].trim()}\"\n                            />\n                        </a>\n                        <ul class=\"img-info\">\n                            <li class=\"info\">\n                                <svg class=\"icon-info\" name=\"like\" width=\"18\" height=\"18\">\n                                    <use href=\"${BASE_URL}/img/sprite.svg#icon-like\"></use>\n                                </svg>\n                                <p>${likes}</p>\n                            </li>\n                            <li class=\"info\">\n                                <svg class=\"icon-info\" width=\"18\" height=\"18\">\n                                    <use href=\"${BASE_URL}/img/sprite.svg#icon-eye\"></use>\n                                </svg>\n                                <p>${views}</p>\n                            </li>\n                            <li class=\"info\">\n                                <svg class=\"icon-info\" width=\"18\" height=\"18\">\n                                    <use href=\"${BASE_URL}/img/sprite.svg#icon-dialog\"></use>\n                                </svg>\n                                <p>${comments}</p>\n                            </li>\n                            <li class=\"info\">\n                                <svg class=\"icon-info\" width=\"18\" height=\"18\">\n                                    <use href=\"${BASE_URL}/img/sprite.svg#icon-gallery-download\"></use>\n                                </svg>\n                                <p>${downloads}</p>\n                            </li>\n                        </ul>\n                    </li>`\n        ).join('');\n    \n    gallery.insertAdjacentHTML(\"beforeend\", galleryItemsList);\n    \n    waitForImagesToLoad()\n\n    const lightbox = new SimpleLightbox('.gallery a', {\n        captionsData: 'alt',\n        captionDelay: 250,\n    });\n\n    lightbox.refresh();\n   \n}\n\nexport function clearGallery() {\n    gallery.innerHTML = ''\n}\n\n\n//------------FUNCTION CHANGED SEARCHBAR ICON COLOR IF SOME VALUE INPUTED------------\n\n\nexport function changeIconColor(icon) {\n    const searchBar = document.querySelector('.form');\n    //removing prev listener = adding nev\n    searchBar.removeEventListener('input', changeColor);\n    searchBar.addEventListener('input', changeColor);\n       \n    function changeColor(event) {\n        icon.style.fill = event.target.value.trim() ? '#1875FF' : '';\n    }\n}\n\n\n//------------------------------------MESSAGES--------------------------------------\n\n\nexport function errorMessage(message) {\n iziToast.error({\n   message: message,\n   position: window.innerWidth <= 768 ? 'bottomCenter' : 'topCenter',\n   transitionIn: 'fadeInDown',\n   backgroundColor: 'rgb(231, 19, 36)',\n   messageColor: 'white',\n   iconColor: 'white',\n   messageSize: '16px',\n   class: 'toast',\n});\n}\n\nexport function infoMessage(message) {\n iziToast.info({\n   message: message,\n   position: window.innerWidth <= 768 ? 'bottomLeft' : 'topLeft',\n   transitionIn: 'fadeInDown',\n   messageSize: '16px',\n});\n}\n\n//-----------------------------------LOADER FUNCTIONS----------------------------------------\n\n\nexport function addLoading() {\n    const loader = document.querySelector('.loader');\n    loader.classList.remove('visually-hidden')\n    gallery.classList.add('visually-hidden')\n    \n    loader.style.display = 'block'\n}\n\nexport function removeLoading() {\n    const loader = document.querySelector('.loader');\n    loader.classList.add('visually-hidden')\n    gallery.classList.remove('visually-hidden')\n    \n    loader.style.display = 'none';  \n}\n\n//Функцію додав щоб вирішити проблему з завантаженням сторінки.\n//Так як у мене likes, views, comemnts, downloads реалізовані іконками\n//то іконки завантажувались швидше за зображення і виглядало це не добре.\nexport function waitForImagesToLoad() {\n    const gallery = document.querySelector('.gallery');\n    if (!gallery) {\n        removeLoading();\n        return;\n    }\n\n    const images = gallery.querySelectorAll('img');\n    let loadedCount = 0;\n\n    if (images.length === 0) {\n        removeLoading(); //Якщо немає зображень, одразу ховаємо лоадер\n        removeNextPageloader()\n        return;\n    }\n\n    images.forEach(img => {\n        if (img.complete && img.naturalHeight !== 0) {\n            loadedCount++; //Якщо зображення вже готове\n        } else {\n            img.onload = () => {\n                loadedCount++;\n                checkIfAllImagesLoaded();\n            };\n            img.onerror = () => {\n                if (!img.src.includes('image-not-found.jpg')) {\n                    img.src = '/goit-js-hw-11/img/image-not-found.jpg'; //ставимо заглушки якщо помилка\n                    img.alt = 'Image not found';\n                    img.onerror = null; \n                }\n                \n                loadedCount++; //Якщо зображення не завантажилося, теж  враховуємо\n                checkIfAllImagesLoaded();\n            };\n        }\n    });\n\n    checkIfAllImagesLoaded();\n\n    if (loadedCount === images.length) {\n        checkIfAllImagesLoaded();\n    }\n\n    function checkIfAllImagesLoaded() {\n        if (loadedCount === images.length) {\n            removeLoading(); //Ховаємо лоадер тільки коли все намальовано\n            \n        }\n    } \n}\n\n\n\n\n//---------------------FUNCTION HANDLE LIKE YOUR FAVORITE IMAGES-----------------------------\n\n\nexport function clickOnlike() {\n    gallery.addEventListener('click', event => {\n        if (event.target.tagName === 'use') {\n            const like = event.target.closest('svg');\n            const likesValue = like.nextElementSibling;\n            \n            if (like.getAttribute('name') === 'like') {\n                let numberOfLikes = Number(likesValue.textContent);\n\n                if (like.style.fill !== 'darkblue') {\n                    like.style.fill = 'darkblue';\n                    like.style.transform = 'scale(1.1)'\n                    likesValue.style.color = 'darkblue';\n                    numberOfLikes++;\n                } else {\n                    like.removeAttribute('style');\n                    likesValue.removeAttribute('style')\n                    numberOfLikes--;\n                }    \n\n                likesValue.textContent = numberOfLikes;\n            }\n            \n        }\n    })\n          \n}\n\nexport function hideElement(element) {\n    element.classList.add('visually-hidden')\n}\n\nexport function showElement(element) {\n    element.classList.remove('visually-hidden')\n}\n\nexport function showNextPageloader() {\n    const pageLoader = document.querySelector('.page-loader');\n    pageLoader.classList.remove('visually-hidden');\n\n}\n\nexport function removeNextPageloader() {\n    const pageLoader = document.querySelector('.page-loader');\n    pageLoader.classList.add('visually-hidden');\n    \n    \n}\n\n","\nimport { getImagesByQuery } from './js/pixabay-api';\nimport {\n    errorMessage, addLoading, changeIconColor, clearGallery, clickOnlike,\n    createGallery, infoMessage, waitForImagesToLoad, hideElement, showElement,\n    showNextPageloader, removeNextPageloader\n}\n    from './js/render-functions';\n\n\nconst searchBar = document.querySelector('.form');\nconst icon = document.querySelector('.icon-img');\nconst loadMoreBtn = document.querySelector('.load-btn')\nhideElement(loadMoreBtn)\n\nfunction handleSubmit() {\n    searchBar.addEventListener('submit', async event => {\n        event.preventDefault();\n        clearGallery();\n\n        let query = event.target['search-text'].value.trim();\n        searchBar.dataset.query = query;\n        if (!query) {\n            infoMessage('Enter some value');\n            return;\n        }\n        \n        loadMoreBtn.dataset.page = '1';\n        searchBar.dataset.query = query;\n\n        addLoading()\n\n            try {\n                const response = await getImagesByQuery(query)\n                if (response.data.hits.length === 0) {\n                    throw new Error(`Sorry, there are no images matching ${query}. Please try again!`);\n                }\n                \n                createGallery(response.data.hits);  \n            }\n            \n            catch(error) {\n                if (error.message.includes('no images')) {\n                    infoMessage(error.message);\n                } else {\n                    errorMessage('Something went wrong. Please try again later.');\n                }\n                \n                clearGallery();   \n            }\n        \n            finally {\n                waitForImagesToLoad();\n                showElement(loadMoreBtn)\n            }\n            \n    })\n\n}\n   \nloadMoreBtn.addEventListener('click', loadMore)\n\n async function loadMore() {\n     let page = Number(loadMoreBtn.dataset.page) + 1;\n     loadMoreBtn.dataset.page = page;\n     let query = searchBar.dataset.query;\n     hideElement(loadMoreBtn);\n     showNextPageloader()\n    if (query) {\n       try {\n            const response = await getImagesByQuery(query, page);\n            createGallery(response.data.hits);\n        }\n        \n       catch (error) {\n            console.error('Load more error:', error);\n            errorMessage('Failed to load more images.');\n        }\n\n       finally {\n           \n            removeNextPageloader()\n            showElement(loadMoreBtn)\n        }\n     }\n     \n     \n     \n}\n\nchangeIconColor(icon)\nhandleSubmit()\nclickOnlike()  \n    \n"],"names":["getImagesByQuery","query","page","axios","BASE_URL","gallery","createGallery","images","galleryItemsList","likes","views","downloads","comments","tags","largeImageURL","webformatURL","waitForImagesToLoad","SimpleLightbox","clearGallery","changeIconColor","icon","searchBar","changeColor","event","errorMessage","message","iziToast","infoMessage","addLoading","loader","removeLoading","loadedCount","removeNextPageloader","img","checkIfAllImagesLoaded","clickOnlike","like","likesValue","numberOfLikes","hideElement","element","showElement","showNextPageloader","loadMoreBtn","handleSubmit","response","error","loadMore"],"mappings":"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"}